const app=new Vue({el:"#app",data:{title:"Control de Estudio",alert:!1,alertt:!1,students:[],teacher:!1,user:{},table:localStorage.getItem("table"),search:"",data:{formPrimary:{dni:"",nombres:"",apellidos:""},formSecondary:{userOpsu:"",passOpsu:""},formThird:{email:"",passEmail:""}},steps:{one:!0,two:!1,three:!1,four:!1}},methods:{next(t){switch(t){case 2:""!=this.data.formPrimary.dni&&""!=this.data.formPrimary.nombres&&""!=this.data.formPrimary.apellidos?(this.steps.one=!1,this.steps.two=!0):(this.alert=!0,setTimeout(()=>{this.alert=!1},1e3));break;case 3:""!=this.data.formSecondary.userOpsu&&""!=this.data.formSecondary.passOpsu?(this.steps.two=!1,this.steps.three=!0):(this.alert=!0,setTimeout(()=>{this.alert=!1},1e3));break;case"done":""!=this.data.formPrimary.dni&&""!=this.data.formPrimary.nombres&&""!=this.data.formPrimary.apellidos&&""!=this.data.formSecondary.userOpsu&&""!=this.data.formSecondary.passOpsu&&""!=this.data.formThird.email&&""!=this.data.formThird.passEmail?(this.steps.three=!1,this.steps.four=!0,axios.post("https://uecav.herokuapp.com/api/student",this.data).then(t=>{console.log(t),t.data.repeat&&Swal.fire({icon:"error",title:"Oops...",text:"Ya estas registrado..."}),this.all()}).catch(t=>{console.log(t)})):(this.alert=!0,setTimeout(()=>{this.alert=!1},1e3))}},previous(t){switch(t){case 1:this.steps.one=!0,this.steps.two=!1,this.steps.three=!1;break;case 2:this.steps.one=!1,this.steps.two=!0,this.steps.three=!1}},login(){"@uecav"===this.user.username&&"123456"===this.user.password?(localStorage.setItem("table","true"),console.log(this.tableGet),this.teacher=!1,this.table=!0,this.user.username="",this.user.password=""):(this.alertt=!0,setTimeout(()=>{this.alertt=!1},1e3))},logout(){localStorage.removeItem("table"),this.table=!1},all(){axios.post("https://uecav.herokuapp.com/api/all").then(t=>{this.students=t.data}).catch(t=>{console.log(t)})},deleteItem(t){Swal.fire({title:"¿Desea eleminar este registro?",text:"No podrá revertir esta acción",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si, eliminar"}).then(e=>{e.value&&axios.delete(`https://uecav.herokuapp.com/api/delete/${t._id}`).then(t=>{t.data.dlt&&this.all(),Swal.fire("Listo!","Registro eliminado exitosamente.","success")}).catch(t=>{console.log(t)})})},generatePdf(){var t=new jsPDF("l","pt"),e=t.autoTableHtmlToJson(document.getElementById("basic-table"));t.autoTable(e.columns,e.data,{margin:{top:80}});var s={beforePageContent:function(e){t.setFontSize(18),t.setTextColor(40),t.setFontStyle("normal")},margin:{top:80}};t.autoTable(e.columns,e.data,s),t.save("Datos graduandos - OPSU.pdf")}},computed:{stepOne(){return!(""==this.data.formPrimary.dni||""==this.data.formPrimary.nombres||!this.data.formPrimary.apellidos)},stepTwo(){return""!=this.data.formSecondary.userOpsu&&""!=this.data.formSecondary.passOpsu},stepThree(){return""!=this.data.formThird.email&&""!=this.data.formThird.passEmail},filterStudents(){return this.students.filter(t=>t.cedula.toString().match(this.search)||t.names.toLowerCase().match(this.search.toLowerCase())||t.lastnames.toLowerCase().match(this.search.toLowerCase())||t.username.toLowerCase().match(this.search.toLowerCase())||t.passUser.toLowerCase().match(this.search.toLowerCase())||t.email.toLowerCase().match(this.search.toLowerCase())||t.passEmail.toLowerCase().match(this.search.toLowerCase()))}},mounted(){this.all()}});window.addEventListener("load",function(t){document.querySelector("#view").classList.remove("hide"),document.querySelector(".load").classList.add("d-none")});